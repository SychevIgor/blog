Уже достаточно давно в Microsoft Azure был выпущен сервис Api Management. На Хабре его <a href="http://habrahabr.ru/company/microsoft/blog/223467/">анонсировали</a> в мае.  

<h4><b>Идея</b></h4>
Microsoft, как всегда, предлагает разработчикам сосредоточится на том, что делает их приложение уникальным — на самом бизнес-функционале, а инфраструктуру вокруг него использовать стандартную.
<img src="http://habrastorage.org/files/294/8e0/537/2948e053766a4c6bb2655e04bc96f599.png" alt="image"/>
<b>Api Management</b>– это proxy, через которую мы можете определить типы подписок, тарификацию, настроить тротлинг/throtling, квоты/quotas, настроить списки доступа, вести модерацию пользователей Api, вести мониторинг использования. Т.е. вы со своего приложения снимаете то, что не определяет его бизнес-ценности для потребителя, и отдаете это на откуп Api Management. Где, на самом деле, хостится приложение при таком proxy - это не так важно для ваших клиентов (точка входа одна), а приложение можете и on Premise хостить, и в облаке.

Мне кажется, что это логическое продолжения концепции, которую Microsoft показала еще в Azure Data market.
<habracut/>
Все о чем рассказывается нижу, доступно в виде <a href="http://www.microsoftvirtualacademy.com/training-courses/introduction-to-azure-api-management-rus">видеокурса</a>  на Microsoft Virtual Academy.

<b>Ключевые концепции</b>
<ul>
	<li>Операция — вызываемый метод api. Тут все параметры, возвращаемые данные. В общем, то, что делает непосредственно действие. Конфигурация самого низкого уровня относится именно к операции.</li>
	<li>Api агрегирует набор операций (от 1 до N). Конфигурация и логическое объединение операций. Операции входят только в 1 Api.</li>
	<li>Продукт агрегирует набор api (от 1 до N). Сущность, которая предоставляется разработчикам, использующим Api, именно она тарифицируется. </li>
</ul>

Пример:
Допустим, у нас есть приложение, в котором можно переводить документы. 
Доменная модель: есть документ, у документа есть предложения их которых оно состоит, у предложения могут быть ревизии (версии перевода разными людьми, или в разное время).
Концепции будем на ревизиях обсуждать.

Есть 2 операции: чтение всех ревизий сегмента и откат сегмента к какой-то ревизии.
Эти 2 операции объединены в один api – Revisions.
Само Revisions Api входит в продукт, в который, кроме него, входят еще Api работы с документами и самими сегментами. Но есть еще один продукт, в который это Revisions Api не входит, ибо клиенту оно не нужно, все переводится с первой попытки. 

Мы можем из разного набора Api конфигурировать продукты, под конкретные пожелания потребителя.

<h4><b>Операции/Operations</b></h4>
Операция — это, фактически, метод api, который вызывается. Все его параметры настраиваются.
В <a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-add-operations/">статье </a>хорошо рассказано следующее:
Как создать операцию, как установить http код ответа, как установить http глагол для операции, как создать список входных параметров, шаблон uri, пример текста ответа, установить тип возвращаемого контента, и если кэшировать, то сколько.
<img src="http://habrastorage.org/files/403/373/ed3/403373ed366543b89900428813fb4060.png" alt="image"/>
<img src="http://habrastorage.org/files/a64/3cc/89a/a643cc89a8ac45e0a46a1ec4fe2020a8.png" alt="image"/>
<img src="http://habrastorage.org/files/590/46c/4ff/59046c4ff4494c998ff11b52ccc8f425.png" alt="image"/>
<img src="http://habrastorage.org/files/bf0/d10/e6a/bf0d10e6a8c84d51b1526208c7dff2ad.png" alt="image"/>
<img src="http://habrastorage.org/files/201/b5b/f2b/201b5bf2b32641e7bb12027371b367d9.png" alt="image"/>

<h4><b>Api</b></h4>
<a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-create-apis/ ">Создание api</a> ничего сложного из себя не представляет- это uri + суффикс к нему(постфикс) и описание. После можно добавить в него операции, посмотреть список issues.
Api можно не только создать вручную, но и <a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-import-api/  его в wadl/swigger">импортировать/экспортировать</a>  форматах.

<h4><b>Продукты/Products</b></h4>
Продукт - это то, что получает его потребитель. На уровне продукта устанавливается лицензионное соглашение, на этом уровне устанавливается кто может пользоваться этим api, тарифный план, какие api в него входят, нужно ли получить approve, чтобы использовать api, или нет.
Надо понять, что сам Api вне продукта никому не видим, а в продукте становится доступным только после публикации Api. Т.е. мы можем заранее создать продукты, но не публиковать их до поры до времени. Есть 2 интересные статьи как <a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-add-products/">шаг</a> за <a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-product-with-rules/">шагом </a> настраивать продукты.

<h4><b>Группы/Groups</b></h4>
<a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-create-groups/">Группа </a>— это объединение пользовательских аккаунтов(windows live id, email.). Есть 3 предконфигурированные группы, но мы можем создать любое их количество. 
Созданную группу мы должны привязать к продукту, чтобы они могли что-то с этими api делать. 
<ul>
	<li>Встроенныя группа администраторы — это те пользователи, которые могут менять настройки api.</li>
	<li>Developers – это встроенная группа пользователей, которые могут использовать Api.</li>
	<li>Guests – это не авторизованные пользователи. Им можно дать права на просмотр api, но не вызов. Так сказать, «смотреть, руками не трогать».</li>
</ul>

<h4><b>Политики/Policies</b></h4>
Я бы назвал их pre/post обработчики вызовов api, которые способны менять его поведение в зависимости от своих настроек. 
Сами политики могут быть привязаны как к продуктам, так и непосредственно к api или даже операциям. Это называется Policy Scope.
Политики бывают входные и выходные. Сами они определяются в xml формате.

<b>Вот пример ограничения на IP</b>
<img src="http://habrastorage.org/files/f5c/185/e84/f5c185e84b76498da754f5ba11f5a715.png"/>
<img src="http://habrastorage.org/files/27c/1f8/8b4/27c1f88b49a34684bffa42e13605de80.png" alt="image"/>

Сейчас это жестко заданный набор потенциально возможных политик, полный список которых можно прочесть <a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-policy-reference">здесь</a>.
Приведу список без описания:
<ul>
	<li>Ограничительные<ul>
	     <li>Квоты.</li>
	     <li>Лимиты</li>
	     <li>Ограничения на IP</li>
          </ul>
        </li>
	<li>Трансформации контента <ul>
             <li>Установить Http заголовки</li>
	     <li>Конвертировать из xml в json.</li>
	     <li>Заменить строку в теле сообщения</li>
	     <li>Установить/заменить параметр запроса.</li>
          </ul>
       </li>
<li>Кэширование</li>
<li>Остальные<ul>		
	<li>URI rewrite</li>
	<li>Разрешить кросс доменные вызовы.</li>
	<li>JSONP</li>
	<li>CORS</li></ul></li></ul>

<h4><b>Мониторинг/отчеты</b></h4>
Думаю, одним из самых интересных моментов будет система отчетности по используемым api. Кто, откуда, сколько раз запросил, как часто сервис не отвечал — это базовые вопросы, которые у всех возникают, и эта информация у вас будет из коробки.
<img src="http://habrastorage.org/files/128/83b/053/12883b05316a469f842c56e870fc5b84.png" alt="image"/>
<img src="http://habrastorage.org/files/e01/1a2/43e/e011a243e8de4a8ca3cbb95ec290a6d4.png" alt="image"/>
Использование этой статистике на первом этапе будет большим подспорьем в развитии продукта, хотя в итоге скорее всего придется написать что-нибудь свое... Но до этого времени, вы с экономите кучу времени и денег, прежде чем писать свою систему.


<h4><b>Api Management Api</b></h4>
Т.к. Api Management – это сервис, то у него тоже есть свой Api.
Все, что можно сделать через portal, делается через тот же api, что имеет обычный разработчик. Поэтому Api даже особо описывать смысла нет — это просто работа с операциями, группами, продуктами. Включение, выключение, установка политик и так далее.
Документация по Api <a href="http://msdn.microsoft.com/en-us/library/azure/dn776326.aspx">доступна </a>, SDK на nuget я  нашел от 9 сентября в версии  <a href="http://www.nuget.org/packages/MS.Azure.ApiManagement/0.0.1-alpha3">alpha</a> что странно, для опубликованного сервиса. Да и статей по этой sdk найти не удалось пока.

<h4><b>Кастомизация страницы api</b></h4>
Любому api нужна страница с информацией о нем, желательно стилизованная и брендированная под компанию производителя. Одной страницей лучше не ограничиваться, а собрать небольшой сайт с примерами использования, контактами компании и прочей полезной информацией.
В Api Management для этого представляется CMS (Orchard), с помощью которой можно и добавить страницы с контентом, и добавить и стилизовать сайт через css. 
Естественно, мы должны понимать, что не все возможности стандартного Orchard можно использовать (написание своего кода на C#, например, невозможно), однако, как редактор контента, стилизация вполне выполняет свою задачу. <a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-customize-portal/">Статья </a>как это сделать.  

<h4><b>Цены</b></h4>
На данный момент вы можете выбрать 2 тарифных <a href="http://azure.microsoft.com/en-us/pricing/details/api-management/">плана </a>. 
<ol>
	<li>Developer – Unit за 1.59$ в день, и за день можно отработать 166тысяч запросов, 850мб включенного в стоимость трафика.</li>
	<li>Standard – 11.26 в день и 6600тысяч запросов с 35 включенными в цену гигабайтами данных на передачу.</li>
</ol>
При превышении трафика по данным трафик тарифицируется <a href="http://azure.microsoft.com/en-us/pricing/details/data-transfers/">стандартно</a>, как и во всех остальных сервисах. 

<b>P.S.</b>
Очевидная проблема, на мой взгляд, что если в вашем решении уже есть что-то по аналитике, мониторингу, то вам придется придумать, как связать это все вместе... 
Куда хуже, что вы полностью завязываетесь на платформу в плане авторизации. 
И еще хуже, если Вам придется одновременно предоставлять свое Api через Api Management и напрямую, т.к. это несколько точек настройки, где-то у Вас будет работать ограничение на число запросов, где-то нет... В общем, прежде чем брать этот сервис, стоит детально посмотреть, где функционал вашего решения пересекается с решением из Api Management и что делать, чтобы не дублироваться и не создать себе слоистую архитектуру.

Ссылки
<ul>
	<li><a href="http://azure.microsoft.com/en-us/services/api-management/">Стартовая</a></li>
	<li><a href="http://azure.microsoft.com/en-us/documentation/services/api-management/">Техническая информация о сервисе + видео</a></li>
	<li><a href="http://msdn.microsoft.com/en-us/library/azure/dn776327.aspx">MSDN</a></li>
	<li><a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-get-started/">Кратко обо всем</a></li>
	<li><a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-add-operations/">Операции</a></li>
	<li><a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-howto-api-inspector/">Трассировка запросов и примеры вызова на языках</a></li>
	<li><a href="http://azure.microsoft.com/en-us/documentation/articles/api-management-customize-portal/">Api Management Api</a></li>
	<li><a href="http://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azureapimgmt">Форум</a></li>
</ul>

Если Вы хотите помочь улучшить статью- можно предлогать ваши правки через <a href="https://github.com/SychevIgor/blog_AzureApiManagement/blob/master/README.md">github</a>
