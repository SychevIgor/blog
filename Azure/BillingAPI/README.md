Тех, кто пользуется Azure давно и много, всегда интересовал вопрос- как посмотреть детализацию счета, который был выставлен.
Большими кусками можно было посмотреть либо на account, либо на конкретной подписке на azure.portal.com  
Но лично мне этого всегда не хватало, т.к. сколько операций с диском или с сетью и когда я проводил- там не показано, только агрегированные данные. Данные тут были очень ограниченные: 
 
И вот, летом стало доступно 2 API: Usage API и ScoreCard API.
•	Через Usage API можно получить детализацию с точность от часа, до дня какие ресурсы были потреблены.  https://github.com/Azure-Samples/billing-dotnet-usage-api 
•	ScoreCard API- показывает стоимость какого-либо ресурса, с учетом всех ваших скидок в рамках Enterprise Agreement и им подобным. https://github.com/Azure-Samples/billing-dotnet-ratecard-api/ 
Оба этих API, часть нового API- Azure Resource Manager.

Как это сделать через Powershell.
Сначала надо залогиниться через Login-AzureRmAccount.
 
Затем выбрать интересующий вас диапазон дат.  
Есть один нюанс- сейчас даты API считает не по вашей текущей временной зоне, а по времени в США (в 4 утра 24 декабря по времени Новосибирска, я получил ошибку, что 24 число- это в будущем) 
Поэтому надо выборку делать по американскому времени (а уж западное или восточное побережье- я не проверял)

Пример вывода от API 
 
Как мы видим работа с диском и сетью, расписана до нескольких мегабайт и это на мой взгляд круто. Раньше все время были какие-то биллинговые юниты- но понять, что это- было не тривиально. А тут все более менее прозрачно.

Как я уже упомянул ранее, мы можем получить детализацию по часам, или по дням. Естественное по часам, будет более детальным и большим.
 
То, что powershell выводит в консоль или в файл, было получено в виде Json и данных там немного больше.
Давайте посмотреть какой объект был на самом деле получен. Сделать это можно, либо посмотрев их из powershell, либо открыть пример на C# с github https://github.com/Azure-Samples/billing-dotnet-usage-api  

  

Если вы используете только IAAS, то вы можете использовать решения партнеров
•	Cloudyn https://azure.microsoft.com/en-us/documentation/articles/billing-usage-rate-card-partner-solution-cloudyn/ 
•	Cloudcruiser https://azure.microsoft.com/en-us/documentation/articles/billing-usage-rate-card-partner-solution-cloudcruiser/ 
Решения партнеров– работают не только с Azure, но и с Amazon, Google, а так-же с OnPremise Cloud решениями, типа Azure Pack.

Я лично, не смог запустить Usage API пример на C#. Причина- powershell достаточно, чтобы вы были залогинены, а .net приложению почему-то нужно иметь доступ к Azure active directory, а мне надо быть его администратором... В такие моменты, понимаешь, что быть сотрудником microsoft иногда тяжело, ибо где искать админа azure ad- я понятия не имею. На github завел issue https://github.com/Azure-Samples/billing-dotnet-usage-api/issues/1 https://github.com/Azure-Samples/billing-dotnet-ratecard-api/issues/1 , может авторы API почитают и согласятся, что нужно более простое решение.

