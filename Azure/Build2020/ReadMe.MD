Прошло 2 недели с Online конференции Build 2020. Пыль улеглась, было время проанализировать и попробовать анонсированные технологии. Microsoft Russia уже делал свой <a href="https://habr.com/ru/company/microsoft/blog/503004/">обзор</a>, но у меня совершенно другой взгляд на наиболее важные анонсы. Предлагаю вам свою подборку самых интересных изменений и их анализ.

Кроме того, т.к. я посетил Build 2019 лично, то решил собрать свое мнение о том, что потеряла конференция с уходом полностью в online. 

Microsoft разделила свои <a href="https://news.microsoft.com/build-2020-book-of-news/">анонсы </a>на 5 категорий. Я сфокусируюсь на обновлениях по <b>Azure </b>и некоторым очень интересным анонсам для <b>web</b>, <b>mobile/desktop</b> разработчиков. 
<cut/>

В 2019 году было более тысячи сессий. В 2020 – 600 сессий, многие из которых  -  это повторение одного и того же для разных часовых поясов. Получается, что уникальных сессий было всего около 400. <b>Т.к. количество сессий снизилось, я не ждал большого числа анонсов. </b>

<spoiler title="Краткое summary по Microsoft 365/Security/Windows/Edge&Bing, которые не были основным фокусом этой статьи:">
<ul>
	<li><b>Microsoft 365</b> не входит в сферу моих интересов, но, на мой взгляд, общий тренд следующий: Covid-19 массово отправил людей работать из дома, никто не верит, что сотрудники быстро и в полном составе вернутся в офисы (офисы надо переделывать, а это время и деньги), поэтому любые решения по организации совместной работы распределенных коллективов будут заходить “на УРА”. Microsoft в качестве такой точки кристаллизации использует Microsoft Teams, вокруг которой строится экосистема.</li>
	<li><b>Security</b> (нишевые вещи изменились, и, на мой взгляд, не заслуживают даже отдельной секции в этой статье)
<ul>
	<li>Вышли обновления к SDK для MSAL/Microsoft Identity platform. По-моему, довольно минорное обновление.</li>
	<li>Обновился Azure Active Directory – не думаю, что интересно широкой аудитории.</li>
	<li>В Azure Security Center появилось Score API и Alertы стало удобнее фильтровать. Сарказм: алерты - это прямо невероятная фича, даже и не знаю, как они смогли!</li>
</ul></li>
	<li><b>Windows</b><ul>
	<li>В Windows Subsystem for Linux добавлены UI-специфичные фичи. Не думаю, что на Linux прямо много UI софта, без которого ни одна домохозяйка не проживет. А вот сделать что-то, чтобы <b>Data Scientist в каких-то сценариях могли, не пересаживаясь с Windows, запускать свои Data Tools и выполнять расчеты, не выходя из Windows</b>, – <b>это </b>вполне себе <b>сценарий</b>, хотя и очень узкоспециализированный.</li>
	<li>Про Project Reunion расскажу отдельно вместе с MAUI, т.к. обе анонса - это про очередную унификацию разработки на Windows. </li>
	<li>Про остальные, на мой взгляд, узкоспециализированные анонсы писать не буду.</li>
</li></ul>
	<li><b>Edge&Bing</b> - Достаточно минорные обновления/мало кому релевантные, так что даже описывать нет смысла.</li>
</ul>
</spoiler>

<h2>Web разработка</h2>
Тут тоже без революций. Детали можно прочесть <a href="https://devblogs.microsoft.com/aspnet/asp-net-core-updates-in-net-5-preview-4/">тут</a> и <a href="https://devblogs.microsoft.com/dotnet/announcing-net-5-preview-4-and-our-journey-to-one-net/">тут</a>.
Если свести 2 статьи в короткому резюме, то получится следующее:
<ul>
	<li>HTTP 1.1/2.0 стало быстрее</li>
	<li>На ARM процессорах стало быстрее</li>
	<li>Размер container images стал еще меньше</li>
	<li>Научились собирать практически в 1 файл приложение и все его dllки</li>
	<li>Улучшили предсказуемость времени обработки запроса. Т.е. стали биться над улучшением результата не для не percentile 50, а percentile 95.
<img src="https://habrastorage.org/webt/qb/r5/6e/qbr56exdyhpszppnw_qnlnfgd2i.png" /></li>
</ul>
Всегда приятно, когда приложение начинает работать быстрее, публикация приложения занимает меньше времени (если docker образ уменьшился). 

<b>Но я бы обратил внимание, на ARM и предсказуемость. Я считаю, что этими обновлениями Microsoft целится в том числе в IoT/IoT Edge/5G</b> (обещает сделать революцию во многих сферах), где как раз часто нужно предсказуемое время ответа, размер образа очень важен, т.к. доставляется по сети и т.п. 

<b>Обновления Blazor до 3.2</b>, я комментировать не хочу, т.к. не верю в широкое распространение этой технологии.

<b>Entity Framework Core</b>
Даже обсуждать нечего, в комментариях под <a href="https://devblogs.microsoft.com/dotnet/announcing-entity-framework-core-5-0-preview-4/">анонсом</a> много едких комментариев уровня- “вы там что, все в отпуске было с прошлого build?” Да, делают CosmosDB провайдер... и что, это все за год упорной работы?

<b>Подводя итоги по Вебу
Если бы вы впали в кому год сразу после Build2019, и проснулись уже на Build2020 - вас бы удивил только формат конференции, а нее анонсы по вебу. </b>

<h2>Azure</h2>
Самая большая часть изменений связана с Azure, но, если честно, многие из них на столько небольшие, что в ”тучные на релизы” годы  о них можно было даже не упоминать.

Приятно, что наконец-то <b>Windows контейнеры для AKS</b> (Managed Kubernetes) вышли в <b>GA</b>. Можно даже на одном кластере, но в разных Pools иметь и Linux, и windows приложения (важно, когда мигрируются старые приложения или большие решения из множества частей).

<b><a href="https://techcommunity.microsoft.com/t5/azure-app-service/introducing-app-service-static-web-apps/ba-p/1394451">Azure Static Apps</a> (не путать со Static Web Sites) </b>
Из названия я предположил, что это ребрендиг Azure Statc Web Sites с улучшениями (Когда у нас сайт лежит в azure storage account, накрыт сверху CDN и это все вместе называется static web sites), но я не угадал. На самом деле, это новый хостинг для статических вебсайтов со <a href="https://docs.microsoft.com/en-us/azure/static-web-apps/overview#key-features">множеством фичей</a>, который вы ожидаете от веб хостинга. <img src="https://habrastorage.org/webt/5u/py/xu/5upyxucthipu3acqgul4fc8qcoc.png" />
Но это только для тех, чей контент лежит на github и компилируется через github. А остальные? А мы можем игнорировать это сервис, т.к. без github он не работает.

Кроме того, в документации-рекламе сказано, что сервис бесплатный, но на <a href="https://azure.microsoft.com/en-us/pricing/details/app-service/static/">официальной странице с ценами</a> все честно и сказано: “бесплатно в preview. Цены будут объявлены позже”. Я даже<a href="https://github.com/MicrosoftDocs/azure-docs/issues/56537"> не удержался и попросил документацию исправить</a>, чтобы она не была похожа на кричащую рекламу.
<s>Мысли в слух: кажется, Microsoft таки начал превращать github в полноценную часть компании.</s>

<b>Azure ARC</b> (был анонсирован на Ignite в Ноябре 2019) для Kubernetes и Virtual Machines – вышел в <b>public preview</b>. Дополнительных технических деталей не анонсировали, но теперь этот сервис можно хотя бы потрогать. Azure ARC - это такой способ управлять вашими on-premises ресурсами из портала Azure. Нужно установить специальный агент, который будет общаться с вашей инфраструктурой и Azure Portal/API. Я уже говорил, что Microsoft переходит от подхода: “Azure – это расширение вашего датацентра” к подходу “Ваш датацентр- это то, что еще не вынесено в Azure”.

<b>AKS</b> (Managed Kubernetes Cluster) завезли <b>в Azure Stack Hub</b>(Программно-аппаратный комплекс, который монтируется в вашем датацентре и предоставляется схожий набор API и схожий портал, как в большом Azure) в preview. Раньше был доступен только ACS Engine, который делал вам не managed cluster, а все-таки unmanaged cluster, но хотя бы его создавал с минимальными трудозатратами с вашей стороны.  

В ARM добавили <b>“<a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/template-deploy-what-if">What-If</a>”</b> команду, которая покажет что именно в текущей инфраструктуре будет добавлено, удалено, изменено. Согласен, полезная мелочь. 
<img src="https://habrastorage.org/webt/uk/ek/hi/ukekhi-0hueclnliedgbndpvaxg.png" />
Раньше, можно было вызвать команду Deploy с ключом Verify, который возвращал только можно или нельзя этот шаблон применить, и если упадет, то на каком действии. Но что конкретно будет удалено-добавлено, доступно стало только с “What-If”

<b>Azure Application Insights</b> стало возможным добавить в приложения на <b>Java/NodeJS</b>, которые хостятся на Azure App Services или AKS, без изменения исходного кода <b>(Codeless integration)</b>. Для .Net это минимум год, но Microsoft следует свой политике, что Azure – это не только Windows и .Net, но все остальные популярные технологии.

<h3><b><a href="https://techcommunity.microsoft.com/t5/azure-ai/build-2020-conversational-ai-updates/ba-p/1397685">Bots и связанные с ними сервисы</a></b></h3>
Bot Framework и сервисы с ним связанные достаточно сильно обновили. <a href="https://docs.microsoft.com/en-us/azure/bot-service/what-is-new?view=azure-bot-service-4.0">Улучшения в Bot Framework</a> перечислять и комментировать не буду т.к. давно плотно не работал. 
Самое заметное то, что <b>Bot Framework Composer выпустили в GA</b>. Т.к. очень уж хочется <b>писать ботов</b> не на C#/NodeJs, а все-таки <b>в графическом дизайнере блоками</b>. <img src="https://habrastorage.org/webt/rp/36/aa/rp36aacqe8vjihmsj3bkhrhsaqs.png" />
Понятно, что рано или поздно в процессе эксплуатации придется-таки перейти на код, но многие простые сценарии можно и без этого сделать. 

<b>В QnA maker сделали rich text editor </b>для ответов. Это была боль, когда в ответ можно было отдать только plain text. 
<img src="https://habrastorage.org/webt/n5/gp/vn/n5gpvnvzuizfdxyybtv-jl7zfnw.jpeg" /> 
От формата подачи ответа очень многое зависит. Всегда хотелось ключевую часть ответа подсветить, сделать другим шрифтом и т.п., чтобы обратить внимание людей. Теперь это возможно. 

<b>Azure Cognitive Search</b>
А<a href="https://techcommunity.microsoft.com/t5/azure-ai/build-the-best-search-experience-in-your-application-with-new/ba-p/1403656">нонсировали 2 preview фичи в Azure Search</a>- интеграция с Azure Machine Learning и Customer Ranking. 
<b>Общее ощущение, что для сервиса сменился(появился) другой вектор развития, а именно - поддержка разработчиков ботов.</b>
Например, можно из текста <b>вычленить PII данные</b>, если часть текста не на основном языке - <b>перевести</b>. А с использованием Azure ML сервиса  к тексту можно сделать очень много разных enrichments.
<b>Custom Ranking</b> тоже полезная вещь, т.к. раньше можно было тюнить веса полей при ранжировании. Теперь можно целый <a href="https://docs.microsoft.com/en-us/azure/search/index-add-scoring-profiles#workflow">DSL</a> использовать, чтобы вычислить значение. 
<s>За последние 4 года я помню мало изменений. Кроме ребрендинга с добавлением модного слова Cognitive (возможность через Cognitive Service Vision Service/OCR вытащить из картинки текст и объекты, добавив их в индекс) и появления HD SKU).
</s>

<h4>CosmosDB ServerLess и AutoScale</h4>
Microsoft идет все больше в Serverless, вот и <a href="https://devblogs.microsoft.com/cosmosdb/autoscale-serverless-offers/">CosmosDB Serverless завезли</a> (годом ранее завезли SQL Database Serverless)
CosmosDB был и есть очень дорогим решением т.к. платить надо было за фиксированный в Request Units уровень производительности. Это очень сильно противоречило идее, что cloud native приложения должны гибко адаптироваться к изменению нагрузки, а CosmosDB фактически заставлял по худшему сценарию резервировать мощность.
<img src="https://habrastorage.org/webt/ey/eq/8b/eyeq8bv9bqi6bxd7sh5qqms-h6o.png" />
<b>Но работает Serverless для CosmosDB не совсем так, как раньше для SQL Database. Т.е. оплата идет только за фактически потребленные RU, но не за минимальный уровень.</b>

<b>Autoscaling</b> – тоже правильная фича, с точки зрения настоящей cloud native разработки. 
<img src="https://habrastorage.org/webt/5t/vo/hd/5tvohdzj-ssjwv6hkbl4cq46f0a.png" />
Autoscaling для CosmosDB выглядит именно так, как он выглядел для SQL Database (одно и то же название и разное поведение, конечно, вызовет проблемы для архитекторов, но с неконсистентностью придется жить). Вы указываете нижнюю границу по которой всегда будете платить и верхнюю границу - до которой можно потреблять ресурсы по необходимости. В итоге платить вы будете за минимальный уровень + то, что было потреблено сверх него (на графике - за площадь под синей кривой)

<b><a href="https://docs.microsoft.com/en-us/azure/cosmos-db/synapse-link">Azure Synapse Link</a></b>
Теперь, можно из Azure Synapse напрямую делать запросы в первичные источники данных типа CosmosDB (и в будущем Azure SQL, Azure Database for PostgreSQL and Azure Database for MySQL), без предварительной заливки данных через ETL в сам Synapse. (Synapse – до ребрендига – Datawarehouse).
<img src="https://habrastorage.org/webt/e3/8h/xs/e38hxscql_jauvbsq1ogsnfw5k0.png" />
Если коротко, то создается дополнительный column store, который автоматически обновляется, и уже к нему через Synapse Link идет подключение. Раньше, Microsoft очень часто “продавали” CosmosDB, как аналитическую базу, которой она не являлась и потом тем, кто на ней должны были делать аналитику- очень сильно ругались. Теперь, маркетинг и имплементация не должны расходиться.

<b>Postgress/MySQL</b>
Serverless пока не анонсировали, по этому довольствуемся громким заявлением, что Microsoft будет больше и активнее инвестировать в Postgress/MySQL PaaS. За заявление – спасибо. Пока завезли интеграцию с Azure Active Directory, возможность сделать предоплату на несколько лет вперед (Reserved Instances) и много разных изменений. Возможно, те, кто часто используется Postgress/MySQL PaaS в Azure, высоко оценят эти изменения, но, на мой взгляд, это просто эволюционное развитие, и никаких громких анонсов по MySQL/Postgress не было.

<b>SQL Edge</b>
SQL Edge для IoT сценариев вышел в GA. Но его еще год назад анонсировали на build2019, так что новость слабенькая.

<h3>IoT</h3>
Мне тяжело судить о том, насколько важны обновления в разделе IoT, т.к. мне не довелось еще в реальном IoT проекте поучаствовать. Поэтому мое мнение – это мнение абстрактного специалиста по Azure. 

Очень интересно звучит возможность <b>добавить карту своего здания, в Azure Maps Private Atlas</b>. Т.е. есть у вас план этажа, то к нему расположение IoT устройств можно сделать. Карта будет доступна только вам. Наверняка можно это сделать и без Azure Maps, но звучит полезно.

Для <b>IoT Hub</b> можно теперь <b>пустить трафик</b> не через публичную сеть, а <b>через vpn</b> и только потом <b>в IoT Hub</b>. <img src="https://habrastorage.org/webt/7c/a9/lr/7ca9lr-ttjvmhajbbp3jk_itg9y.png" />
Я так понял, что это сценарий не для бурильных установок в степях, где с интернетом в принципе плохо, а для сценариев, где IoT девайсы стоят на пример в офисе компании или умном здании (smart building) и имеется хорошая сеть, которую можно использовать, чтобы доставить телеметрию в Azure, в обход публичного интернета.

Digital Twins/RTOS не готов комментировать.

<b>Подводя итоги по Azure анонсов
Я бы сказал так: спокойное, планомерное развитие, без революций относительно прошлого календарного года. Какие-то новые тренды я не смог выделить, все как и раньше - Data+AI/IoT.</b>

<h2><b>Windows Development</b></h2>
Microsoft не была бы Microsoft, если бы с целью унификации разработки не анонсировала сразу 2 платформы. 
Я уже давно сбился со счета, сколько раз Microsoft выкатывала новые desktop/mobile фреймворки и application models, которые, по заверению маркетологов и евангелистов, были лучше предыдущих, и каждый раз они были не совместимы с предыдущими решениями, в которые сообщество разработчиков уже успело инвестировать свое время. 

<h3><a href="https://github.com/dotnet/maui">.Net MAUI</a></h3>
<img src="https://habrastorage.org/webt/0c/xs/op/0cxsopshwi4xijji_lahefoiq8y.png" />
На этот раз, Microsoft из Xamarin.Forms сделало фреймворк, который должен был в очередной раз дать разработчикам возможность писать “одно приложение и запускать его на разных платформах”. На данный момент под разными платформами подразумевается IOS/Android/Mac/Linux/Windows. Должен признать, что список целевых платформ приятно радует, т.к. как ранее под разными платформами в основном подразумевалась последняя версия windows/windows phone/xbox. 
Целевая дата выхода - <b>Ноябрь 2021</b> (.Net 6). До этого момента еще много времени, и бросаться с головой в этот омут не стоит.

В комментариях к анонсу много отсылок на “Flutter” и <b><a href="https://platform.uno">Platform.uno</a></b> , что Microsoft создает то, что уже есть.
<spoiler title="C одной стороны - комментаторы правы и варианты уже есть. ">
С другой стороны - вы серьезно считаете, что одна из самых больших в мире компаний по рыночной капитализации отдаст на откуп “сообществу” такой важный кусок, как единая платформа разработки mobile/desktop приложений? Microsoft из стратегических соображений должен написать свое решение в этой области, чтобы иметь вертикально интегрированный стек технологий. Можно вспомнить и другие примеры такого подхода, которые можно было бы вместе охарактеризовать “это написали не они”.
</spoiler>
<h3>Project Reunion</h3>
В теории выглядит не плохо (хотя надо было делать еще в 2012 году до появления WinRT). <a href="https://blogs.windows.com/windowsdeveloper/2020/05/19/developing-for-all-1-billion-windows-10-devices-and-beyond/">Красивая анимация</a>. 
<img src="https://habrastorage.org/webt/at/9h/ed/at9hedzgy6f5u_wyeb3ywsozjw0.png" />
Вместо Win32 API и UWP API – у нас будет прослойка, которую нужно будет вызывать, а она уже будет проксировать вызовы дальше. Она будет распространяться через nuget пакеты (не очень понятно только, как быть с разными версиями UWP API на разных версиях Windows 10) и будет доступна для модернизации приложений в том числе и на WPF/Winforms/UMP/ReactNative

Точных дат, понятное дело, нет, но если верить планам, то <b><a href="https://github.com/microsoft/ProjectReunion/blob/master/docs/roadmap.md"> когда-нибудь в 2021++</a></b>. Я интерпретирую эти даты как 2022 год. Исходных кодов пока не завезли, но обещали.

<b>Подводя итоги по Windows для разработчиков
Я бы сказал так: анонсировать еще 2 несовместимые со всеми предыдущими платформы, требующие основательного переписывания кода, с отдаленными датами выхода (через 1.5 года) не звучит как стратегия быстрой победы. Свое время я бы на это не тратил ближайшие года 1.5, а там уже будет build2021, на котором всегда можно анонсировать еще пару платформ для унификации предыдущих.</b>

<h3>Разное</h3>
Не вижу смысла обсуждать темы типа Квантовые вычисления и Суперкомпьютер Microsoft, т.к. это замечательный повод “срубить хайпа”. Мою жизнь, как разработчика или архитектора, это никак не затрагивает. То, что Holelens2 завезли в Европу и Азию замечательно, но я был удивлен, что раньше он был недоступен в этих регионах. Project Bonsai сервис для создания автономных автомобилей- круто, но нам то что с этого хайпа?! (сколько из нас делают такие системы?)  

<h2>Общее впечатление от мероприятия</h2>
<b>Когда другие крупные компании просто отменяли конференции, Microsoft попытался провести конференцию, пусть и в нетрадиционном формате. За попытку мое уважение. </b>
<b>Количество сессий и анонсов сильно упало</b>- Если в своем отчете за 2019 год, мне было очень тяжело перечислить все обновления и улучшения, то в 2020 году такой проблемы не было. 

<spoiler title="Почему так произошло? Я не знаю, но есть предположение.">
Не думаю, что у Microsoft не хватает денег, инженеры массово стали болеть или из дома они работают не эффективно.
С началом пандемии, когда компании массово отправили своих сотрудников на “удаленку”, у Microsoft Azure начался кризис с доступностью ресурсов (нельзя было создать: sql database, виртуальные машины для free trial/msdn подписок и многие другие типы ресурсов). 
<b>Суть моего предположения в том, что запуск новых сервисов и фичей был деприоритезирован в пользу оптимизации и преодоления кризиса нехватки ресурсов (не до жиру). Когда кризис с нехваткой ресурсов будет так или иначе преодолён, думаю мы услышим много новых анонсов, т.к. вряд ли всех программистов “бросили на баррикады”.</b>
Microsoft сделала красивое заявление, что приоритезированы запросы на ресурсы для тех организаций, кто борется с эпидемией, но позиция, откровенно говоря, слабая. Когда у твоих конкурентов сверху и снизу (AWS/GCP) проблем с наличием ресурсов таких масштабов не наблюдалось, кто-то начинает догадываться, что у вас просто резерв мощностей был ниже, вот они и закончились. Может быть, у Microsoft всплеск потребления был пропорционально выше, чем у конкурентов, но такой статистики я не нашел.
</spoiler>
<b>Отсутствие Exhibition</b>. Exhibition в 2019 году - это огромное пространство, где можно было подойти к компаниям-партнерам Microsoft. Лично мне было очень интересно пройтись, попросить личную демку на 3-5 минут, задать свои вопросы на понимание. Делать то же самое из дома через гугл было бы сильно дольше.

<b>Особенности онлайн формата</b>
Возможно, моя личная проблема в том, что я не из поколения Z. (Говорят, что для них разницы между онлайн и оффлайн нет.) 
<spoiler title="Но я не прочувствовал той же торжественности/серьезности момента, как это было на мероприятиях с живым присутствием. ">
Раньше как было: спикер выходил на сцену, на которую направлен свет, в зале темно. Торжественная музыка, объёмный звук. Ты готов сопереживать почти сакральному действию. 

Сравните с онлайн мероприятием: сидишь ты дома, в майке и тапках, пьешь чай. Докладчик тоже сидит из дома, тоже в майке, на фоне видно фикус. Докладчик читает презентацию и в уголке транслируется его лицо через веб камеру, а ля стрим геймера на twitch. Ощущение таинства полностью отсутствует.

Я бы сравнил это с бракосочетанием, когда все такие нарядные, оркестр, цветы. А с другой стороны - когда ты на сайте вроде ГосУслуг в 3 клика отмечаешь, что теперь вы женаты. Совершенно разные эмоции.

До появления всевозможных систем виртуальной реальности, онлайн формат не будет вызывать того восторга, который получаешь, если присутствуешь лично. 
</spoiler>